/*! reactionizer 2016-06-18 */
function initData(){global_teams=new Array;for(var a=0;a<static_teams.length;a++){var b=static_teams[a];global_teams.push({city:b.city,name:b.name,lat:b.lat,lon:b.lon,tz:b.tz,orig_div:b.orig_div})}for(rivalry_costs=new Array,a=0;a<static_rivalry_costs.length;a++){for(var c=new Array,d=0;a>d;d++)c.push(static_rivalry_costs[a][d]/4);rivalry_costs.push(c)}updateScoreMatrices(global_teams)}function updateScoreMatrices(a){var b=0,c=0,d=0;distance_costs=new Array,timezone_costs=new Array,division_costs=new Array;for(var e=0;e<a.length;e++){distance_costs[e]=new Array,timezone_costs[e]=new Array,division_costs[e]=new Array;for(var f=0;e>f;f++){var g=a[e],h=a[f];distance_costs[e][f]=getDistanceCost(g,h),distance_costs[e][f]>b&&(b=distance_costs[e][f]),timezone_costs[e][f]=getTimeZoneCost(g,h),timezone_costs[e][f]>c&&(c=timezone_costs[e][f]),division_costs[e][f]=getDivisionCost(g,h),division_costs[e][f]>d&&(d=division_costs[e][f])}}for(e=0;e<a.length;e++)for(f=0;e>f;f++)distance_costs[e][f]=distance_costs[e][f]/b,timezone_costs[e][f]=timezone_costs[e][f]/c,division_costs[e][f]=division_costs[e][f]/d}function getDistanceCost(a,b){var c=a.lat*(Math.PI/180),d=b.lat*(Math.PI/180),e=a.lon*(Math.PI/180),f=b.lon*(Math.PI/180),g=(f-e)*Math.cos((c+d)/2),h=d-c;return Math.sqrt(g*g+h*h)}function getTimeZoneCost(a,b){return Math.abs(a.tz-b.tz)}function getDivisionCost(a,b){return a.orig_div==b.orig_div?0:a.orig_div%3==b.orig_div%3?2:3}function updateCosts(){costs=new Array;for(var a=getDistanceWeight()*DISTANCE_WEIGHT_MODIFIER,b=getRivalryWeight()*RIVALRY_WEIGHT_MODIFIER,c=getTimezoneWeight()*TIMEZONE_WEIGHT_MODIFIER,d=getDivisionWeight()*DIVISION_WEIGHT_MODIFIER,e=0;e<global_teams.length;e++){costs[e]=new Array;for(var f=0;e>f;f++)costs[e][f]=a*distance_costs[e][f]+b*rivalry_costs[e][f]+c*timezone_costs[e][f]+d*division_costs[e][f]}}function changeTeamCity(a,b){global_teams[a].city=global_cities[b].city,global_teams[a].lat=global_cities[b].lat,global_teams[a].lon=global_cities[b].lon,global_teams[a].tz=global_cities[b].tz,global_teams[a].orig_div=global_next_empty_division,global_next_empty_division-=3,divisions=initDivisions(),moveTeamMarker(a,global_cities[b].lat,global_cities[b].lon),updateTable(divisions),updateMap(divisions),updateScoreMatrices(global_teams),updateCosts(),global_relocated_teams[a]=b,addMovedTeamRow(a,global_cities[b].city),setBookmark(divisions.string)}function revertTeamCity(a){global_teams[a].city=static_teams[a].city,global_teams[a].lat=static_teams[a].lat,global_teams[a].lon=static_teams[a].lon,global_teams[a].tz=static_teams[a].tz,global_teams[a].orig_div=static_teams[a].orig_div,divisions=initDivisions(),moveTeamMarker(a,static_teams[a].lat,static_teams[a].lon),updateTable(divisions),updateMap(divisions),updateScoreMatrices(global_teams),updateCosts(),delete global_relocated_teams[a],setBookmark(divisions.string),removeMovedTeamRow(a)}function DivisionList(a,b,c){this.string=a,this.div_count=c,this.conf_count=b,this.score=0}function gaIterate(a,b){window.clearTimeout(ga_timeout);for(var c=0;c<a.length;c++)a[c].score||a[c].calculateScore();if(a.sort(byScore),updateTable(a[0]),updateMap(a[0]),continuing_flag){for(c=Math.ceil(b);GA_GENERATION_SIZE>c;c++){var d,e=randomInt(Math.ceil(b));do d=randomInt(Math.ceil(b));while(d==e);a[c]=a[e].crossWith(a[d])}for(c=0;GA_GENERATION_SIZE>c;c++)Math.random()<GA_MUTATION_CHANCE&&a[c].mutate();b>GA_MIN_SURVIVORS&&(b+=GA_SURVIVORS_DELTA),ga_timeout=window.setTimeout(function(){gaIterate(a,b)},GA_ITERATION_INTERVAL)}else setBookmark(a[0].string)}function byScore(a,b){return a.score-b.score}function updateDivisionCount(a){$(".div_button").removeClass("selected"),$("#division_count_selector_"+a).addClass("selected"),global_division_count=a,divisions=initDivisions(),resetPolygons(),updateScreenLayout(),updateTableFormat(divisions),updateMap(divisions),updateTable(divisions),setBookmark(divisions.string)}function updateConferenceCount(a){$(".conf_button").removeClass("selected"),$("#conf_count_selector_"+a).addClass("selected"),$(".div_button").removeClass("disabled").removeAttr("disabled"),global_conference_count=a,3==a?($("#division_count_selector_4").addClass("disabled").attr("disabled","disabled"),$("#division_count_selector_2").addClass("disabled").attr("disabled","disabled"),4!=global_division_count&&2!=global_division_count||updateDivisionCount(6)):2==a&&($("#division_count_selector_3").addClass("disabled").attr("disabled","disabled"),3==global_division_count&&updateDivisionCount(6)),divisions=initDivisions(),resetPolygons(),updateScreenLayout(),updateTableFormat(divisions),updateMap(divisions),updateTable(divisions),setBookmark(divisions.string)}function getDistanceWeight(){return $("#distance_weight_slider").slider("option","value")}function getTimezoneWeight(){return $("#timezone_weight_slider").slider("option","value")}function getRivalryWeight(){return $("#rivalry_weight_slider").slider("option","value")}function getDivisionWeight(){return $("#division_weight_slider").slider("option","value")}function initMap(){global_polygons=new Array,global_markers=new Array;var a=new google.maps.LatLng(41,-96),b={zoom:4,center:a,maxZoom:6,minZoom:3,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map"),b);for(var c=0;c<global_teams.length;c++){var d=global_teams[c],e=new google.maps.LatLng(d.lat,d.lon);global_markers[c]=new google.maps.Marker({position:e,title:d.city+" "+d.name,icon:getLogoURL(d)}),global_markers[c].setMap(map)}initPolygons()}function resetPolygons(){for(var a=0;a<global_polygons.length;a++)for(var b=0;b<global_polygons[a].length;b++)global_conference_count>a&&global_division_count/global_conference_count>b?global_polygons[a][b].setMap(map):global_polygons[a][b].setMap(null)}function initPolygons(){for(var a=0;a<conference_colors.length;a++){for(var b=new Array,c=conference_colors[a],d=0;d<c.length;d++){var e=new google.maps.Polygon({strokeColor:conference_colors[a][d],strokeWeight:3,fillColor:conference_colors[a][d],fillOpacity:0});e.setMap(map),b.push(e)}global_polygons.push(b)}}function moveTeamMarker(a,b,c){global_markers[a].setPosition(new google.maps.LatLng(b,c)),global_markers[a].setAnimation(google.maps.Animation.DROP)}function initialize(a){initData(),processBookmark(),ReactDOM.render(React.createElement(Divisionizer,{initConferences:"1",initDivisions:"4",teams:global_teams,cities:global_cities,initString:a}),document.getElementById("container"))}function processBookmark(){if(location.hash){var a=location.hash.substring(1).split(":");global_conference_count=a[0],global_division_count=a[1];for(var b=3;b<a.length;b++){var c=a[b],d=c.split("^");changeTeamCity(d[0],d[1])}}}function initInterface(){$("#distance_weight_slider").slider({max:10,value:5,change:updateCosts}),$("#rivalry_weight_slider").slider({max:10,value:5,change:updateCosts}),$("#division_weight_slider").slider({max:10,value:5,change:updateCosts}),$("#timezone_weight_slider").slider({max:10,value:5,change:updateCosts}),$("#relocationizer").dialog({autoOpen:!1,modal:!0,minHeight:100,minWidth:400});var a=global_teams.slice(0);a.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0});for(var b=0;b<a.length;b++){var c=global_teams.indexOf(a[b]);$("#relocationizer_teams").append("<option value='"+c+"'>"+a[b].name+"</option>")}for(b=0;b<global_cities.length;b++)$("#relocationizer_cities").append("<option value='"+b+"'>"+global_cities[b].city+"</option>");updateDivisionCount(global_division_count),updateConferenceCount(global_conference_count),updateScreenLayout()}function openRelocationDialog(){$("#relocationizer").dialog("open")}function relocateTeam(){var a=$("#relocationizer_teams option:selected").attr("value"),b=$("#relocationizer_cities option:selected").attr("value");changeTeamCity(a,b)}function addMovedTeamRow(a,b){removeMovedTeamRow(a),$("#relocated_teams").append('<div class="relocated_team" id="team'+a+'">Relocated <span class="old_team">'+global_teams[a].name+'</span> to <span class="new_city">'+b+'</span>&nbsp;<a href="javascript:revertTeamCity('+a+');">Undo</a></div>')}function removeMovedTeamRow(a){$("#relocated_teams #team"+a).remove()}function initDivisions(){var a;if(location.hash){var b=location.hash.substring(1).split(":");a=b[2]}else a=DivisionList.getDefaultString();return new DivisionList(a,global_conference_count,global_division_count)}function setBookmark(a){a=global_conference_count+":"+global_division_count+":"+a;for(var b=0;b<global_teams.length;b++)global_relocated_teams[b]&&(a+=":"+b+"^"+global_relocated_teams[b]);location.hash="#"+a,$("#fb_share").attr("href","http://www.facebook.com/sharer/sharer.php?u=http://www.divisionizer.com/%23"+a),$("#tw_share").attr("href","http://www.twitter.com/home?status=http://www.divisionizer.com/%23"+a)}function updateTableFormat(a){$("#divisions").empty();for(var b=a.div_count,c=a.conf_count,d=a.toArray(),e=b/c,f=0;c>f;f++)for(var g=0;e>g;g++){$("#divisions").append('<div class="division column'+b+'" id="c'+f+"d"+g+'"><div class="header">Division '+(g+1)+'<div class="legend" style="background:'+conference_colors[f][g]+'"></div></div></div>');for(var h=d[f][g],i=0;i<h.length;i++)$("#c"+f+"d"+g).append('<div class="team" id="c'+f+"d"+g+"t"+i+'"></div>')}$(".team").draggable({revert:!0}).droppable({drop:handleDrop,hoverClass:"droppable"})}function updateTable(a){for(var b=a.toArray(),c=a.div_count/a.conf_count,d=0;d<a.conf_count;d++)for(var e=0;c>e;e++)for(var f=b[d][e],g=0;g<f.length;g++){var h=f[g];$("#c"+d+"d"+e+"t"+g).text(h.city+" "+h.name)}}function updateMap(a){for(var b=a.toArray(),c=a.div_count/a.conf_count,d=0;d<a.conf_count;d++)for(var e=0;c>e;e++){for(var f=b[d][e],g=new Array,h=0;h<f.length;h++){var i=f[h];g.push(new google.maps.LatLng(i.lat,i.lon))}global_polygons[d][e].setPaths(g)}}function getLogoURL(a){return"logos/"+a.name.toLowerCase().replace(" ","")+".png"}function handleDrop(a,b){var c=initDivisions(),d=global_teams.length/c.conf_count,e=global_teams.length/c.div_count,f=$(this).attr("id"),g=b.draggable.attr("id"),h=f.match(/\d+/g),i=new Number(h[0])*d+Math.ceil(new Number(h[1])*e)+new Number(h[2]),j=g.match(/\d+/g),k=new Number(j[0])*d+Math.ceil(new Number(j[1])*e)+new Number(j[2]);c.string=c.string.swapChars(i,k),delete c.conferences,b.draggable.css("top","0px").css("left","0px"),updateTable(c),updateMap(c),setBookmark(c.string)}function divisionize(){$("#divisionizer_on").show(),$("#divisionizer_off").hide(),$(".conf_button").addClass("disabled").attr("disabled","disabled"),$(".div_button").addClass("disabled").attr("disabled","disabled");var a=new Array;continuing_flag=!0;for(var b=0;GA_GENERATION_SIZE>b;b++)a.push(DivisionList.getRandom(global_conference_count,global_division_count));gaIterate(a,GA_MAX_SURVIVORS)}function stop_divisionize(){$(".conf_button").removeClass("disabled").removeAttr("disabled"),$(".div_button").addClass("disabled").attr("disabled","disabled"),$(".div_button").removeClass("disabled").removeAttr("disabled"),3==global_conference_count?($("#division_count_selector_4").addClass("disabled").attr("disabled","disabled"),$("#division_count_selector_2").addClass("disabled").attr("disabled","disabled")):2==global_conference_count&&$("#division_count_selector_3").addClass("disabled").attr("disabled","disabled"),$("#divisionizer_on").hide(),$("#divisionizer_off").show(),continuing_flag=!1}function randomInt(a){return Math.floor(Math.random()*a)}var Header=React.createClass({displayName:"Header",render:function(){return React.createElement("div",{id:"head-logo"},"header")}}),SettingsMenu=React.createClass({displayName:"SettingsMenu",render:function(){return React.createElement("div",{id:"settings_container"},React.createElement("div",{id:"settings_header"},"Settings",React.createElement("button",null,"open")),React.createElement("div",{id:"settings_menu"},React.createElement(ConferenceSelector,{conferences:this.props.conferences,divisions:this.props.divisions,onConferenceChange:this.onConferenceChange}),React.createElement(Relocationizer,{teams:this.props.teams,cities:this.props.cities})))},onConferenceChange:function(a,b){this.props.onConferenceChange(a,b)}}),ConferenceSelector=React.createClass({displayName:"ConferenceSelector",getInitialState:function(){return{conferences:this.props.conferences,divisions:this.props.divisions}},render:function(){var a=[3,2,1].map(function(a){return React.createElement(SelectorButton,{type:"conference",key:"conference"+a,value:a,selected:a==this.state.conferences,disabled:!1,onButtonClick:this.conferenceUpdate})},this),b=[6,4,3,2].map(function(a){return React.createElement(SelectorButton,{type:"division",key:"division"+a,value:a,selected:a==this.state.divisions,disabled:a%this.state.conferences!=0,onButtonClick:this.divisionUpdate})},this);return React.createElement("div",{className:"field"},React.createElement("label",null,"Organize teams into:"),React.createElement("div",{className:"subfield"},React.createElement("label",null,"Conferences"),React.createElement("div",null,a)),React.createElement("div",{className:"subfield"},React.createElement("label",null,"Divisions"),React.createElement("div",null,b)))},conferenceUpdate:function(a){this.setState({conferences:a});var b=this.state.divisions;this.state.divisions%a!=0&&(b=6,this.setState({divisions:b})),this.props.onConferenceChange(a,b)},divisionUpdate:function(a){this.setState({divisions:a}),this.props.onConferenceChange(this.state.conferences,a)}}),SelectorButton=React.createClass({displayName:"SelectorButton",render:function(){var a="div_button"+(this.props.selected?" selected":"")+(this.props.disabled?" disabled":""),b=this.props.type+"_count_selector_"+this.props.value;return React.createElement("button",{className:a,id:b,disabled:this.props.disabled,onClick:this.handleClick},this.props.value)},handleClick:function(a){this.props.onButtonClick(this.props.value)}}),Relocationizer=React.createClass({displayName:"Relocationizer",render:function(){var a=this.props.teams.map(function(a){return React.createElement("option",{key:a.name},a.name)}),b=this.props.cities.map(function(a){return React.createElement("option",{key:a.city},a.city)});return React.createElement("div",null,React.createElement("div",{className:"field"},React.createElement("h3",null,"Relocate team"),React.createElement("div",null,React.createElement("div",null,React.createElement("label",null,"from"),React.createElement("select",null,a)),React.createElement("div",null,React.createElement("label",null,"to"),React.createElement("select",null,b)),React.createElement("div",null,React.createElement("button",null,"Relocate Team")))),React.createElement("div",{className:"field"},React.createElement("h3",null,"Expansion team"),React.createElement("div",null,React.createElement("div",null,React.createElement("label",null,"city"),React.createElement("select",null,b)),React.createElement("div",null,React.createElement("label",null,"name"),React.createElement("input",{type:"text"})),React.createElement("div",null,React.createElement("button",null,"Create Team")))))}}),Map=React.createClass({displayName:"Map",render:function(){return React.createElement("div",{id:"map"},"This is a map.")}}),LeagueDisplay=React.createClass({displayName:"LeagueDisplay",render:function(){var a=this.props.league.map(function(a,b){return React.createElement(Conference,{conference:a,key:b})});return React.createElement("div",{id:"teams"},a)}}),Conference=React.createClass({displayName:"Conference",render:function(){var a=this.props.conference.map(function(a,b){return React.createElement(Division,{division:a,key:b})});return React.createElement("div",{className:"conference"},a)}}),Division=React.createClass({displayName:"Division",render:function(){var a=this.props.division.map(function(a){return React.createElement(Team,{team:a,key:a.name})});return React.createElement("div",{className:"division"},React.createElement("div",{className:"name"},this.props.division.name),React.createElement("div",{className:"list"},a))}}),Team=React.createClass({displayName:"Team",render:function(){var a=getLogoURL(this.props.team);return React.createElement("div",{className:"team"},React.createElement("img",{className:"team-logo",src:a}),React.createElement("span",{className:"city"},this.props.team.city),React.createElement("span",{className:"name"}," ",this.props.team.name))}}),Footer=React.createClass({displayName:"Footer",render:function(){return React.createElement("div",{id:"footer"},"footer")}}),Divisionizer=React.createClass({displayName:"Divisionizer",getInitialState:function(){return{conference_count:this.props.initConferences,division_count:this.props.initDivisions,string:this.props.initString}},onAddTeam:function(a){allTeams.conferences[0].divisions[0].teams.push({name:a}),this.setState({teams:allTeams})},onConferenceChange:function(a,b){this.setState({conference_count:a,division_count:b})},render:function(){var a=new DivisionList(this.state.string,this.state.conference_count,this.state.division_count),b=a.toArray();return React.createElement("div",{id:"divisionizer"},React.createElement(Header,null),React.createElement("div",{className:"application"},React.createElement(SettingsMenu,{conferences:this.state.conference_count,divisions:this.state.division_count,teams:this.props.teams,cities:this.props.cities,onRelocateTeam:this.onRelocateTeam,onAddTeam:this.onAddTeam,onConferenceChange:this.onConferenceChange}),React.createElement("div",{className:"content"},React.createElement(Map,{league:b}),React.createElement(LeagueDisplay,{league:b}))),React.createElement(Footer,null))}}),distance_costs=new Array,rivalry_costs,timezone_costs=new Array,division_costs=new Array,costs=new Array,division_count,global_cities,global_teams,global_next_empty_division=-4,global_relocated_teams=new Array,static_teams,DIVISION_WEIGHT_MODIFIER=1,RIVALRY_WEIGHT_MODIFIER=2,DISTANCE_WEIGHT_MODIFIER=9,TIMEZONE_WEIGHT_MODIFIER=3;static_teams=[{city:"Anaheim",name:"Ducks",lat:33.807778,lon:-117.876667,orig_div:0,tz:3},{city:"Dallas",name:"Stars",lat:32.790556,lon:-96.810278,orig_div:0,tz:1},{city:"Los Angeles",name:"Kings",lat:34.043056,lon:-118.267222,orig_div:0,tz:3},{city:"Phoenix",name:"Coyotes",lat:33.531944,lon:-112.261111,orig_div:0,tz:2},{city:"San Jose",name:"Sharks",lat:37.332778,lon:-121.901111,orig_div:0,tz:3},{city:"Calgary",name:"Flames",lat:51.0375,lon:-114.051944,orig_div:1,tz:2},{city:"Colorado",name:"Avalanche",lat:39.748611,lon:-105.0075,orig_div:1,tz:2},{city:"Edmonton",name:"Oilers",lat:53.571389,lon:-113.456111,orig_div:1,tz:2},{city:"Minnesota",name:"Wild",lat:44.944722,lon:-93.101111,orig_div:1,tz:1},{city:"Vancouver",name:"Canucks",lat:49.277778,lon:-123.108889,orig_div:1,tz:3},{city:"Columbus",name:"Blue Jackets",lat:39.969283,lon:-83.006111,orig_div:2,tz:0},{city:"Chicago",name:"Blackhawks",lat:41.880556,lon:-87.674167,orig_div:2,tz:1},{city:"Detroit",name:"Red Wings",lat:42.325278,lon:-83.051389,orig_div:2,tz:0},{city:"Nashville",name:"Predators",lat:36.159167,lon:-86.778611,orig_div:2,tz:1},{city:"St. Louis",name:"Blues",lat:38.626667,lon:-90.2025,orig_div:2,tz:1},{city:"Boston",name:"Bruins",lat:42.366303,lon:-71.062228,orig_div:3,tz:0},{city:"Buffalo",name:"Sabres",lat:42.875,lon:-78.876389,orig_div:3,tz:0},{city:"Montreal",name:"Canadiens",lat:45.496111,lon:-73.569444,orig_div:3,tz:0},{city:"Ottawa",name:"Senators",lat:45.296944,lon:-75.927222,orig_div:3,tz:0},{city:"Toronto",name:"Maple Leafs",lat:43.643333,lon:-79.379167,orig_div:3,tz:0},{city:"New Jersey",name:"Devils",lat:40.733611,lon:-74.171111,orig_div:4,tz:0},{city:"New York",name:"Islanders",lat:40.722778,lon:-73.590556,orig_div:4,tz:0},{city:"New York",name:"Rangers",lat:40.750556,lon:-73.993611,orig_div:4,tz:0},{city:"Philadelphia",name:"Flyers",lat:39.901111,lon:-75.171944,orig_div:4,tz:0},{city:"Pittsburgh",name:"Penguins",lat:40.439444,lon:-79.989167,orig_div:4,tz:0},{city:"Carolina",name:"Hurricanes",lat:35.803333,lon:-78.721944,orig_div:5,tz:0},{city:"Florida",name:"Panthers",lat:26.158333,lon:-80.325556,orig_div:5,tz:0},{city:"Tampa Bay",name:"Lightning",lat:27.942778,lon:-82.451944,orig_div:5,tz:0},{city:"Washington",name:"Capitals",lat:38.898056,lon:-77.020833,orig_div:5,tz:0},{city:"Winnipeg",name:"Jets",lat:49.892892,lon:-97.143836,orig_div:-1,tz:1}],global_cities=[{city:"Atlanta",tz:0,lat:33.755,lon:-84.39},{city:"Hartford",tz:0,lat:41.762736,lon:-72.674286},{city:"Hamilton",tz:0,lat:43.255278,lon:-79.873056},{city:"Houston",tz:1,lat:29.762778,lon:-95.383056},{city:"Kansas City",tz:1,lat:39.109722,lon:-94.588611},{city:"Las Vegas",tz:3,lat:36.175,lon:-115.136389},{city:"Milwaukee",tz:1,lat:43.0522222,lon:-87.955833},{city:"Quebec City",tz:0,lat:46.816667,lon:-71.216667},{city:"Seattle",tz:3,lat:47.609722,lon:-122.333056}];var static_rivalry_costs=[[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[1,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[1,2,1,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[2,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[2,3,2,4,4,1,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[3,2,3,4,3,3,2,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[3,2,3,4,3,2,3,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[4,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,4,2,4,4,4,3,2,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[2,2,3,3,2,3,2,3,3,3,3,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,4,3,4,4,4,4,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[4,3,3,4,4,4,4,4,4,4,3,1,1,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[4,4,4,4,3,4,4,4,4,3,4,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[4,4,3,4,4,3,4,3,4,3,4,2,1,4,3,0,2,4,4,4,4,4,4,4,4,4,4,4,4,4],[3,4,4,4,4,3,4,3,4,3,4,4,4,4,4,3,2,2,4,4,4,4,4,4,4,4,4,4,4,4],[4,4,4,4,4,3,4,3,4,3,4,2,1,4,4,0,1,0,2,4,4,4,4,4,4,4,4,4,4,4],[3,3,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,3,4,4,4,3,4,4,4,4,3,3,4,4,2,4,4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4,4,4,4,2,1,4,4,1,3,1,4,2,1,1,4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4,4,4,4,2,4,4,4,2,3,2,3,4,1,2,1,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,3,4,4,4,4,2,2,2,1,4,4,4,4,4,4],[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4],[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,2,4,4,4],[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,3,2,3,3,3,4,4],[4,4,4,3,4,3,4,3,2,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]],DL_DIVISION_MULTIPLIER=3,costs,global_teams,DL_ENCODING_CHARS="1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ",DL_DEFAULT_STRING="IJCGRQFH9T72DEBOAPSNLKM1468053UVWXYZ",DL_ENCODING_BREAK_CHAR=" ",DL_MAX_MUTATIONS=2;DivisionList.prototype.calculateScore=function(){this.score=0;for(var a,b=0;b<global_teams.length;b++)for(var c=0;b>c;c++){if(this.inSameDivision(b,c))a=DL_DIVISION_MULTIPLIER;else{if(!this.inSameConference(b,c))continue;a=1}this.score+=a*costs[b][c]}},DivisionList.prototype.crossWith=function(a){for(var b,c=new Array,d=DivisionList.getDefaultString(),e="",f=0;f<this.string.length;f++){var g=this.string.charAt(f),h=a.string.charAt(f);b=c[g]&&!c[h]?h:c[h]&&!c[g]?g:Math.random()>.5?this.string.charAt(f):a.string.charAt(f),c[b]?e+=DL_ENCODING_BREAK_CHAR:(e+=b,c[b]=1,d=d.setCharAt(d.indexOf(b),""))}for(var i=e.indexOf(DL_ENCODING_BREAK_CHAR,0);i>-1;){var j=randomInt(d.length),k=d.charAt(j);e=e.setCharAt(i,k),d=d.setCharAt(j,""),i=e.indexOf(DL_ENCODING_BREAK_CHAR,0)}return new DivisionList(e,this.conf_count,this.div_count)},DivisionList.prototype.mutate=function(){var a,b=randomInt(DL_MAX_MUTATIONS)+1;for(a=0;b>a;a++){var c,d,e=randomInt(this.string.length),f=DL_ENCODING_CHARS.indexOf(this.string.charAt(e));do c=randomInt(this.string.length),d=DL_ENCODING_CHARS.indexOf(this.string.charAt(c));while(this.inSameDivision(f,d));this.string=this.string.swapChars(e,c)}delete this.score,delete this.conferences},DivisionList.prototype.toArray=function(){this.conferences||this._breakdownDivisions();for(var a=new Array,b=0;b<this.conferences.length;b++){a.push(new Array);for(var c=this.conferences[b],d=0;d<c.length;d++){for(var e=c[d],f=new Array,g=0;g<e.length;g++){var h=DL_ENCODING_CHARS.indexOf(e.charAt(g),0);f.push(global_teams[h])}a[b][d]=f}}return a},DivisionList.prototype.inSameDivision=function(a,b){var c=DL_ENCODING_CHARS.charAt(a),d=DL_ENCODING_CHARS.charAt(b);this.conferences||this._breakdownDivisions();for(var e=0;e<this.conferences.length;e++)for(var f=this.conferences[e],g=0;g<f.length;g++){var h=f[g];if(h.indexOf(c)>-1&&h.indexOf(d)>-1)return!0}return!1},DivisionList.prototype.inSameConference=function(a,b){var c=DL_ENCODING_CHARS.charAt(a),d=DL_ENCODING_CHARS.charAt(b);this.conferences||this._breakdownDivisions();for(var e,f,g=0;g<this.conferences.length;g++){e=!1,f=!1;for(var h=this.conferences[g],i=0;i<h.length;i++){var j=h[i];if(j.indexOf(c)>-1&&(e=!0,f))return!0;if(j.indexOf(d)>-1&&(f=!0,e))return!0}}return!1},DivisionList.prototype._breakdownDivisions=function(){var a,b;6==this.div_count?a=new Array(this.string.substring(0,5),this.string.substring(5,10),this.string.substring(10,15),this.string.substring(15,20),this.string.substring(20,25),this.string.substring(25,30)):4==this.div_count?a=new Array(this.string.substring(0,8),this.string.substring(8,15),this.string.substring(15,23),this.string.substring(23,30)):3==this.div_count?a=new Array(this.string.substring(0,10),this.string.substring(10,20),this.string.substring(20,30)):2==this.div_count&&(a=new Array(this.string.substring(0,15),this.string.substring(15,30)));var c=this.div_count/this.conf_count;b=new Array;for(var d=0;d<this.conf_count;d++){b[d]=new Array;for(var e=d*c;(d+1)*c>e;e++)b[d].push(a[e])}return this.conferences=b,b},DivisionList.getRandom=function(a,b){for(var c=DL_ENCODING_CHARS.substring(0,global_teams.length),d=c.length-1;d>=1;d--){var e=randomInt(d);c=c.swapChars(d,e)}return new DivisionList(c,a,b)},DivisionList.getDefaultString=function(){return DL_DEFAULT_STRING.substring(0,global_teams.length)};var GA_GENERATION_SIZE=80,GA_MAX_SURVIVORS=28,GA_MIN_SURVIVORS=10,GA_SURVIVORS_DELTA=-.3,GA_MUTATION_CHANCE=.4,GA_ITERATION_INTERVAL=200,continuing_flag,ga_timeout,global_division_count=4,global_conference_count=1,static_teams,global_teams,global_cities,map,ga_timeout,global_polygons,global_markers,global_relocated_teams=new Array,conference_colors=new Array(new Array("#1B7EE0","#0F4780","#ADD6FF","#899096","#565A5E","#C8D1DB"),new Array("#F5891D","#944E07","#FFD6AD"),new Array("#7EE01B","#386907"));String.prototype.swapChars=function(a,b){if(a>b){var c=a;a=b,b=c}var d=this.charAt(a),e=this.charAt(b),f=this.substring(0,a),g=this.substring(a+1,b),h=this.substring(b+1,this.length);return f+e+g+d+h},String.prototype.setCharAt=function(a,b){return this.substring(0,a)+b+this.substring(a+1,this.length)};