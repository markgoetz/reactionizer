/*! reactionizer 2016-10-11 */
function initData(){global_teams=new Array;for(var a=0;a<static_teams.length;a++){var b=static_teams[a];global_teams.push({city:b.city,name:b.name,lat:b.lat,lon:b.lon,tz:b.tz,orig_div:b.orig_div})}}function DivisionList(a,b,c){this.string=a,this.div_count=c,this.conf_count=b}function gaIterate(a,b){window.clearTimeout(ga_timeout);for(var c=0;c<a.length;c++)a[c].score||a[c].calculateScore();if(a.sort(byScore),updateTable(a[0]),updateMap(a[0]),continuing_flag){for(c=Math.ceil(b);GA_GENERATION_SIZE>c;c++){var d,e=randomInt(Math.ceil(b));do d=randomInt(Math.ceil(b));while(d==e);a[c]=a[e].crossWith(a[d])}for(c=0;GA_GENERATION_SIZE>c;c++)Math.random()<GA_MUTATION_CHANCE&&a[c].mutate();b>GA_MIN_SURVIVORS&&(b+=GA_SURVIVORS_DELTA),ga_timeout=window.setTimeout(function(){gaIterate(a,b)},GA_ITERATION_INTERVAL)}else setBookmark(a[0].string)}function byScore(a,b){return a.score-b.score}function initMap(){global_polygons=new Array,global_markers=new Array;var a=new google.maps.LatLng(41,-96),b={zoom:4,center:a,maxZoom:6,minZoom:3,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map"),b);for(var c=0;c<global_teams.length;c++){var d=global_teams[c],e=new google.maps.LatLng(d.lat,d.lon);global_markers[c]=new google.maps.Marker({position:e,title:d.city+" "+d.name,icon:getLogoURL(d)}),global_markers[c].setMap(map)}initPolygons()}function resetPolygons(){for(var a=0;a<global_polygons.length;a++)for(var b=0;b<global_polygons[a].length;b++)global_conference_count>a&&global_division_count/global_conference_count>b?global_polygons[a][b].setMap(map):global_polygons[a][b].setMap(null)}function initPolygons(){for(var a=0;a<conference_colors.length;a++){for(var b=new Array,c=conference_colors[a],d=0;d<c.length;d++){var e=new google.maps.Polygon({strokeColor:conference_colors[a][d],strokeWeight:3,fillColor:conference_colors[a][d],fillOpacity:0});e.setMap(map),b.push(e)}global_polygons.push(b)}}function moveTeamMarker(a,b,c){global_markers[a].setPosition(new google.maps.LatLng(b,c)),global_markers[a].setAnimation(google.maps.Animation.DROP)}function initialize(a,b,c,d){processBookmark(),ReactDOM.render(React.createElement(Divisionizer,{initConferences:b,initDivisions:c,teamurl:"data/teams.json",cityurl:"data/cities.json",initString:d}),document.getElementById(a))}function processBookmark(){if(location.hash){var a=location.hash.substring(1).split(":");global_conference_count=a[0],global_division_count=a[1];for(var b=3;b<a.length;b++){var c=a[b],d=c.split("^");changeTeamCity(d[0],d[1])}}}function setBookmark(a){a=global_conference_count+":"+global_division_count+":"+a;for(var b=0;b<global_teams.length;b++)global_relocated_teams[b]&&(a+=":"+b+"^"+global_relocated_teams[b]);location.hash="#"+a,$("#fb_share").attr("href","http://www.facebook.com/sharer/sharer.php?u=http://www.divisionizer.com/%23"+a),$("#tw_share").attr("href","http://www.twitter.com/home?status=http://www.divisionizer.com/%23"+a)}function getLogoURL(a){return"logos/"+a.name.toLowerCase().replace(" ","")+".png"}function stop_divisionize(){$(".conf_button").removeClass("disabled").removeAttr("disabled"),$(".div_button").addClass("disabled").attr("disabled","disabled"),$(".div_button").removeClass("disabled").removeAttr("disabled"),3==global_conference_count?($("#division_count_selector_4").addClass("disabled").attr("disabled","disabled"),$("#division_count_selector_2").addClass("disabled").attr("disabled","disabled")):2==global_conference_count&&$("#division_count_selector_3").addClass("disabled").attr("disabled","disabled"),$("#divisionizer_on").hide(),$("#divisionizer_off").show(),continuing_flag=!1}var allTeams,DivisionList,SettingsMenu,Map,LeagueDisplay,Header=React.createClass({displayName:"Header",render:function(){return React.createElement("header",null,"header")}}),Footer=React.createClass({displayName:"Footer",render:function(){return React.createElement("footer",null,"footer")}}),Divisionizer=React.createClass({displayName:"Divisionizer",propTypes:{initConferences:React.PropTypes.number,initDivisions:React.PropTypes.number,initString:React.PropTypes.string,teamurl:React.PropTypes.string,cityurl:React.PropTypes.string},componentDidMount:function(){$(document).ajaxError(function(a,b,c,d){console.log(d)}),$.ajax({url:this.props.teamurl,context:this,dataType:"json"}).done(function(a){this.setState({teams:a})}),$.ajax({url:this.props.cityurl,context:this,dataType:"json"}).done(function(a){this.setState({cities:a})})},getInitialState:function(){return{conference_count:this.props.initConferences,division_count:this.props.initDivisions,string:this.props.initString,teams:[],cities:[],max_id:32}},onAddTeam:function(a){allTeams.conferences[0].divisions[0].teams.push({id:this.state.max_id++,name:a}),this.setState({teams:allTeams})},onConferenceChange:function(a,b){this.setState({conference_count:a,division_count:b})},render:function(){var a=[];return React.createElement("div",{id:"divisionizer"},React.createElement(Header,null),React.createElement("div",{className:"application"},React.createElement(SettingsMenu,{conferences:this.state.conference_count,divisions:this.state.division_count,teams:this.state.teams,cities:this.state.cities,onRelocateTeam:this.onRelocateTeam,onAddTeam:this.onAddTeam,onConferenceChange:this.onConferenceChange}),React.createElement("div",{className:"content"},React.createElement(Map,{league:a}),React.createElement(LeagueDisplay,{league:a}))),React.createElement(Footer,null))}}),global_teams,static_teams,global_cities;static_teams=[{city:"Anaheim",name:"Ducks",lat:33.807778,lon:-117.876667,orig_div:0,tz:3},{city:"Dallas",name:"Stars",lat:32.790556,lon:-96.810278,orig_div:0,tz:1},{city:"Los Angeles",name:"Kings",lat:34.043056,lon:-118.267222,orig_div:0,tz:3},{city:"Phoenix",name:"Coyotes",lat:33.531944,lon:-112.261111,orig_div:0,tz:2},{city:"San Jose",name:"Sharks",lat:37.332778,lon:-121.901111,orig_div:0,tz:3},{city:"Calgary",name:"Flames",lat:51.0375,lon:-114.051944,orig_div:1,tz:2},{city:"Colorado",name:"Avalanche",lat:39.748611,lon:-105.0075,orig_div:1,tz:2},{city:"Edmonton",name:"Oilers",lat:53.571389,lon:-113.456111,orig_div:1,tz:2},{city:"Minnesota",name:"Wild",lat:44.944722,lon:-93.101111,orig_div:1,tz:1},{city:"Vancouver",name:"Canucks",lat:49.277778,lon:-123.108889,orig_div:1,tz:3},{city:"Columbus",name:"Blue Jackets",lat:39.969283,lon:-83.006111,orig_div:2,tz:0},{city:"Chicago",name:"Blackhawks",lat:41.880556,lon:-87.674167,orig_div:2,tz:1},{city:"Detroit",name:"Red Wings",lat:42.325278,lon:-83.051389,orig_div:2,tz:0},{city:"Nashville",name:"Predators",lat:36.159167,lon:-86.778611,orig_div:2,tz:1},{city:"St. Louis",name:"Blues",lat:38.626667,lon:-90.2025,orig_div:2,tz:1},{city:"Boston",name:"Bruins",lat:42.366303,lon:-71.062228,orig_div:3,tz:0},{city:"Buffalo",name:"Sabres",lat:42.875,lon:-78.876389,orig_div:3,tz:0},{city:"Montreal",name:"Canadiens",lat:45.496111,lon:-73.569444,orig_div:3,tz:0},{city:"Ottawa",name:"Senators",lat:45.296944,lon:-75.927222,orig_div:3,tz:0},{city:"Toronto",name:"Maple Leafs",lat:43.643333,lon:-79.379167,orig_div:3,tz:0},{city:"New Jersey",name:"Devils",lat:40.733611,lon:-74.171111,orig_div:4,tz:0},{city:"New York",name:"Islanders",lat:40.722778,lon:-73.590556,orig_div:4,tz:0},{city:"New York",name:"Rangers",lat:40.750556,lon:-73.993611,orig_div:4,tz:0},{city:"Philadelphia",name:"Flyers",lat:39.901111,lon:-75.171944,orig_div:4,tz:0},{city:"Pittsburgh",name:"Penguins",lat:40.439444,lon:-79.989167,orig_div:4,tz:0},{city:"Carolina",name:"Hurricanes",lat:35.803333,lon:-78.721944,orig_div:5,tz:0},{city:"Florida",name:"Panthers",lat:26.158333,lon:-80.325556,orig_div:5,tz:0},{city:"Tampa Bay",name:"Lightning",lat:27.942778,lon:-82.451944,orig_div:5,tz:0},{city:"Washington",name:"Capitals",lat:38.898056,lon:-77.020833,orig_div:5,tz:0},{city:"Winnipeg",name:"Jets",lat:49.892892,lon:-97.143836,orig_div:-1,tz:1},{city:"Las Vegas",name:"Expansions",lat:36.175,lon:-115.136389,orig_div:-1,tz:3}],global_cities=[{city:"Atlanta",tz:0,lat:33.755,lon:-84.39},{city:"Hartford",tz:0,lat:41.762736,lon:-72.674286},{city:"Hamilton",tz:0,lat:43.255278,lon:-79.873056},{city:"Houston",tz:1,lat:29.762778,lon:-95.383056},{city:"Kansas City",tz:1,lat:39.109722,lon:-94.588611},{city:"Milwaukee",tz:1,lat:43.0522222,lon:-87.955833},{city:"Quebec City",tz:0,lat:46.816667,lon:-71.216667},{city:"Seattle",tz:3,lat:47.609722,lon:-122.333056}];var global_teams,DL_ENCODING_CHARS="1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ",DL_DEFAULT_STRING="IJCGRQFH9T72DEBOAPSNLKM1468053UVWXYZ";DivisionList.prototype.toArray=function(){this.conferences||this._breakdownDivisions();for(var a=new Array,b=0;b<this.conferences.length;b++){a.push(new Array);for(var c=this.conferences[b],d=0;d<c.length;d++){for(var e=c[d],f=new Array,g=0;g<e.length;g++){var h=DL_ENCODING_CHARS.indexOf(e.charAt(g),0);f.push(global_teams[h])}a[b][d]=f}}return a},DivisionList.prototype._breakdownDivisions=function(){var a,b;6==this.div_count?a=new Array(this.string.substring(0,5),this.string.substring(5,10),this.string.substring(10,15),this.string.substring(15,20),this.string.substring(20,25),this.string.substring(25,31)):4==this.div_count?a=new Array(this.string.substring(0,8),this.string.substring(8,15),this.string.substring(15,23),this.string.substring(23,31)):3==this.div_count?a=new Array(this.string.substring(0,10),this.string.substring(10,20),this.string.substring(20,31)):2==this.div_count&&(a=new Array(this.string.substring(0,15),this.string.substring(15,31)));var c=this.div_count/this.conf_count;b=new Array;for(var d=0;d<this.conf_count;d++){b[d]=new Array;for(var e=d*c;(d+1)*c>e;e++)b[d].push(a[e])}return this.conferences=b,b},DivisionList.getDefaultString=function(){return DL_DEFAULT_STRING.substring(0,global_teams.length)};var GA_GENERATION_SIZE=80,GA_MAX_SURVIVORS=28,GA_MIN_SURVIVORS=10,GA_SURVIVORS_DELTA=-.3,GA_MUTATION_CHANCE=.4,GA_ITERATION_INTERVAL=200,continuing_flag,ga_timeout,global_division_count=4,global_conference_count=1,static_teams,global_teams,global_cities,map,global_polygons,global_markers,global_relocated_teams=new Array,conference_colors=new Array(new Array("#1B7EE0","#0F4780","#ADD6FF","#899096","#565A5E","#C8D1DB"),new Array("#F5891D","#944E07","#FFD6AD"),new Array("#7EE01B","#386907"));String.prototype.swapChars=function(a,b){if(a>b){var c=a;a=b,b=c}var d=this.charAt(a),e=this.charAt(b),f=this.substring(0,a),g=this.substring(a+1,b),h=this.substring(b+1,this.length);return f+e+g+d+h},String.prototype.setCharAt=function(a,b){return this.substring(0,a)+b+this.substring(a+1,this.length)};var getLogoURL,dragula,LeagueDisplay=React.createClass({displayName:"LeagueDisplay",propTypes:{league:React.PropTypes.array},componentDidMount:function(){dragula(Array.prototype.slice.call(ReactDOM.findDOMNode(this).querySelectorAll(".division .list"))).on("drop",function(a,b){alert(a.className+" "+b.className)})},render:function(){var a=this.props.league.map(function(a,b){return React.createElement(Conference,{conference:a,key:b,number:b,count:this.props.league.length})},this);return React.createElement("div",{id:"league"},a)}}),Conference=React.createClass({displayName:"Conference",propTypes:{conference:React.PropTypes.array,count:React.PropTypes.number,number:React.PropTypes.number},render:function(){var a=this.props.conference.map(function(a,b){return React.createElement(Division,{division:a,key:b,count:this.props.conference.length*this.props.count,conference:this.props.number,number:b})},this),b="conference col-"+this.props.count;return React.createElement("div",{className:b},a)}}),Division=React.createClass({displayName:"Division",propTypes:{division:React.PropTypes.array,count:React.PropTypes.number,conference:React.PropTypes.number,number:React.PropTypes.number},render:function(){var a=this.props.division.map(function(a){return React.createElement(Team,{team:a,key:a.name})}),b="division col-"+this.props.count+" conf-"+this.props.conference+" div-"+this.props.number;return React.createElement("div",{className:b},React.createElement("div",{className:"name"},"Name"),React.createElement("div",{className:"list"},a))}}),Team=React.createClass({displayName:"Team",propTypes:{team:React.PropTypes.object},render:function(){var a=getLogoURL(this.props.team);return React.createElement("div",{className:"team"},React.createElement("img",{className:"team-logo",src:a}),React.createElement("span",{className:"city"},this.props.team.city),React.createElement("span",{className:"name"}," ",this.props.team.name))}}),google,getLogoURL,Map=React.createClass({displayName:"Map",render:function(){return React.createElement("div",{id:"map"})},componentDidMount:function(){this.polygons=new Array,this.pins=new Array;var a=new google.maps.LatLng(41,-96),b={zoom:4,center:a,maxZoom:6,minZoom:3,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(document.getElementById("map"),b)},_initPins:function(a){for(var b=0;b<a.length;b++){var c=a[b],d=new google.maps.LatLng(c.lat,c.lon),e=new google.maps.Marker({position:d,title:c.city+" "+c.name,icon:getLogoURL(c)});e.setMap(this.map),this.pins.push(e)}},_initPolygons:function(a){},_updatePins:function(){},_updatePolygons:function(){}}),SettingsMenu=React.createClass({displayName:"SettingsMenu",propTypes:{conferences:React.PropTypes.number,divisions:React.PropTypes.number,teams:React.PropTypes.array,cities:React.PropTypes.array,onConferenceChange:React.PropTypes.func},getInitialState:function(){return{menu_open:!1}},render:function(){var a=this.state.menu_open?"open":"closed",b=this.state.menu_open?"close":"open";return React.createElement("div",{id:"settings_container"},React.createElement("h2",{id:"settings_header"},React.createElement("span",null,"Settings"),React.createElement("button",{onClick:this.toggleMenu},b)),React.createElement("div",{id:"settings_menu",className:a},React.createElement(ConferenceSelector,{conferences:this.props.conferences,divisions:this.props.divisions,onConferenceChange:this.onConferenceChange}),React.createElement(Relocationizer,{teams:this.props.teams,cities:this.props.cities})))},onConferenceChange:function(a,b){this.props.onConferenceChange(a,b)},toggleMenu:function(){this.setState({menu_open:!this.state.menu_open})}}),ConferenceSelector=React.createClass({displayName:"ConferenceSelector",propTypes:{conferences:React.PropTypes.number,divisions:React.PropTypes.number,onConferenceChange:React.PropTypes.func},getInitialState:function(){return{conferences:this.props.conferences,divisions:this.props.divisions}},render:function(){var a=[3,2,1].map(function(a){return React.createElement(SelectorButton,{type:"conference",key:"conference"+a,value:a,selected:a==this.state.conferences,disabled:!1,onButtonClick:this.conferenceUpdate})},this),b=[6,4,3,2].map(function(a){return React.createElement(SelectorButton,{type:"division",key:"division"+a,value:a,selected:a==this.state.divisions,disabled:a%this.state.conferences!=0,onButtonClick:this.divisionUpdate})},this);return React.createElement("div",null,React.createElement("div",{className:"field"},React.createElement("h3",null,"Conferences"),React.createElement("div",{className:"subfield"},React.createElement("div",{className:"selector-container"},a))),React.createElement("div",{className:"field"},React.createElement("h3",null,"Divisions"),React.createElement("div",{className:"subfield"},React.createElement("div",{className:"selector-container"},b))))},conferenceUpdate:function(a){this.setState({conferences:a});var b=this.state.divisions;this.state.divisions%a!=0&&(b=6,this.setState({divisions:b})),this.props.onConferenceChange(a,b)},divisionUpdate:function(a){this.setState({divisions:a}),this.props.onConferenceChange(this.state.conferences,a)}}),SelectorButton=React.createClass({displayName:"SelectorButton",propTypes:{selected:React.PropTypes.bool,disabled:React.PropTypes.bool,type:React.PropTypes.string,value:React.PropTypes.oneOfType([React.PropTypes.string,React.PropTypes.number]),onButtonClick:React.PropTypes.func},render:function(){var a="div_button selector "+(this.props.selected?" selected":"")+(this.props.disabled?" disabled":""),b=this.props.type+"_count_selector_"+this.props.value;return React.createElement("button",{className:a,id:b,disabled:this.props.disabled,onClick:this.handleClick},this.props.value)},handleClick:function(){this.props.onButtonClick(this.props.value)}}),Relocationizer=React.createClass({displayName:"Relocationizer",propTypes:{teams:React.PropTypes.array,cities:React.PropTypes.array},render:function(){var a=this.props.teams.map(function(a){return React.createElement("option",{key:a.name},a.name)}),b=this.props.cities.map(function(a){return React.createElement("option",{key:a.city},a.city)});return React.createElement("div",null,React.createElement("div",{className:"field"},React.createElement("h3",null,"Relocate team"),React.createElement("div",{className:"subfield"},React.createElement("label",null,"team"),React.createElement("select",null,a)),React.createElement("div",{className:"subfield"},React.createElement("label",null,"to"),React.createElement("select",null,b)),React.createElement("div",null,React.createElement("button",{className:"action"},"Relocate Team"))),React.createElement("div",{className:"field"},React.createElement("h3",null,"Expansion team"),React.createElement("div",{className:"subfield"},React.createElement("label",null,"city"),React.createElement("select",null,b)),React.createElement("div",{className:"subfield"},React.createElement("label",null,"name"),React.createElement("input",{type:"text"})),React.createElement("div",null,React.createElement("button",{className:"action"},"Create Team"))))}});